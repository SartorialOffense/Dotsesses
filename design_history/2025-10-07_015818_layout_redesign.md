# Layout Redesign - Three-Part Plot Structure

**Date:** 2025-10-07
**Context:** Figma design review and specification update for improved layout

## Background

The user created a Figma design to formalize the main window layout and address several UI issues:
- Cursor selection refinements
- Addition of statistics display (mean, standard deviations, median)
- Better visual separation between plot components
- Improved resizing behavior

**Figma File:** Main-Window-Layout (Zt1nfC8cNIf8fb9E6kiII7, node 2:2)

## Key Design Decisions

### 1. Three-Part Plot Architecture

**Decision:** Use a single OxyPlot instance with three separate rendering areas (subplot regions) instead of overlaying cursors on the dotplot.

**Rationale:**
- Clearer visual separation between components
- Fixed heights for Statistics Display and Grade Cursors
- Only Dot Display resizes with splitter
- Maintains pixel-perfect x-axis alignment across all three areas

**Layout (top to bottom):**
1. **Statistics Display** - Fixed height ~41px
2. **Dot Display** - Variable height ~145px initial, controlled by splitter
3. **Grade Cursors** - Fixed height ~41px

### 2. Statistics Display

**New Feature:** Added dedicated rendering area for statistical markers.

**Components:**
- **Mean (μ):** Vertical dashed line with label above
- **Standard Deviations (±σ):** Show all that fit within score range (±1σ, ±2σ, ±3σ, etc.)
  - Don't draw markers that exceed min/max score range
- **Median:** Single uppercase "M" in tick area below the plot

**Visual Style:**
- Line thickness: 1px
- Color: Light gray
- Dashed lines

**Behavior:**
- Statistics are static - calculated from dataset
- Do NOT change when grades are enabled/disabled

### 3. Grade Region Bands

**Enhancement:** Visual background rectangles in Dot Display to show grade regions.

**Visual Style:**
- Alternating pattern: transparent (clear) and very light gray RGB(36, 36, 36)
- Span full height of Dot Display area
- Example: 5 regions for 4 enabled grades (includes end regions)

**Behavior:**
- Dynamically resize as cursors are dragged
- Only drawn for enabled grades
- Disappear when grade cursor is disabled

### 4. Cursor Interaction Changes

**Simplifications:**
- No crosshairs when dragging cursors
- Visual feedback via resizing grade region bands only

**Label Updates:**
- Labels appear below cursors in Grade Cursors area (not in Dot Display)
- Use regular text style (not semi-transparent)
- Larger font, visible against dark background

### 5. Border Styling

**Change:** All three plot areas now have full outlines (top, left, right, bottom).

**Previous:** Dot Display had bottom border only

**New:** Thin gray line, faint styling on all four sides for all three rendering areas

### 6. Clear Selections Button

**Relocation:** Moved from above dotplot to above drill-down section.

**Behavior:**
- Disabled when no students selected
- Enabled when one or more students selected

**Rationale:** Makes more sense to position button near the content it affects

### 7. Dot Appearance Refinements

**Size:** Marker radius = 4 (was 3× smaller than default)

**Selection Indicator:** Crosshair (dimension = 2× dot diameter) drawn behind dot as non-interactive series (was vertical bar)

### 8. X-Axis Display

**Change:** X-axis hidden (no line, no ticks, no labels)

**Previous:** Bottom axis line only

**Rationale:** Cleaner visual separation between the three rendering areas

## Data-Driven Emphasis

Added prominent note to User Experience section:
> All visualizations are data-driven. The number of grade regions varies based on which grades are enabled. Statistical markers (mean, standard deviations, median) are calculated from the current dataset and do not change when grades are enabled/disabled.

**Key Points:**
- Figma design shows example data (4 grade regions, 8 cursors, specific heights)
- Actual implementation must support variable numbers of grades
- Statistics display adapts to dataset (show all σ markers that fit in range)

## Implementation Notes

### OxyPlot Subplot Configuration

- Use subplot regions feature for three rendering areas
- Share single x-axis across all areas for perfect alignment
- Fixed heights for Statistics Display and Grade Cursors
- Variable height for Dot Display controlled by splitter

### Splitter Behavior

- Horizontal splitter between Grade Cursors and Drill Down
- Affects only Dot Display height
- Statistics Display and Grade Cursors remain fixed
- No min/max constraints currently

## Files Modified

- `SPEC.md` - Updated with new layout structure, Statistics Display section, and refined specifications
- `layout_questions.md` - Created questionnaire with user answers documenting design decisions
- `redo_layout.md` - User's initial layout goals document

## References

- Figma URL: https://figma.com/design/Zt1nfC8cNIf8fb9E6kiII7/Main-Window-Layout?node-id=2-2&p=f&m=dev
- Figma File Key: Zt1nfC8cNIf8fb9E6kiII7
- Node ID: 2:2
